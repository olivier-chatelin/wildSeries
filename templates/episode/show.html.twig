{% extends 'base.html.twig' %}

{% block title %}Episode{% endblock %}

{% block body %}
    <h1>Episode</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ episode.id }}</td>
            </tr>
            <tr>
                <th>Title</th>
                <td>{{ episode.title }}</td>
            </tr>
            <tr>
                <th>Number</th>
                <td>{{ episode.number }}</td>
            </tr>
            <tr>
                <th>Synopsis</th>
                <td>{{ episode.synopsis }}</td>
            </tr>
        </tbody>
    </table>
    <p>
        <a href="{{ path('episode_index') }}">back to list</a>
    </p>
    <p>
        <a href="{{ path('episode_edit', {'slug': episode.slug}) }}">edit</a>
    </p>
    {{ include('episode/_delete_form.html.twig') }}
    <p>
    {% for comment in comments %}
        <div class="border">
            <h5>Commentaire laiss√© par {{ comment.author.firstname }} {{ comment.author.lastname }}</h5>
            <p>note: {{ comment.rate }}/10</p>
            <p>commentaire: {{ comment.comment }}</p>
            {% if app.user and  is_granted("ROLE_ADMIN") or (is_granted("ROLE_CONTRIBUTOR") and app.user == comment.author)%}
            <form method="post" action="{{ path('episode_comment_delete', {'slug': episode.slug, 'comment':comment.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ comment.id) }}">
                <button class="btn btn-danger">Supprimer le commentaire</button>
            </form>
            {% endif %}
        </div>
        {% else %}
        <p>Pas de commentaire pour l'instant</p>
    {% endfor %}
    {% if app.user and is_granted("ROLE_ADMIN") or is_granted("ROLE_CONTRIBUTOR") %}
        <h3>Laisser un commentaire</h3>
        {{ form_start(form) }}
        {{ form_widget(form) }}
        <button class="btn btn-primary">ok</button>
        {{ form_end(form) }}
    {% endif %}
    </p>
{% endblock %}
